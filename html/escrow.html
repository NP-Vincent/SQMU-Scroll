<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Property Escrow</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://c0f4f41c-2f55-4863-921b-sdk-docs.github.io/cdn/metamask-sdk.js"></script>
  <script type="module" src="https://np-vincent.github.io/SQMU-Scroll/js/escrow.js"></script>
  <style>
    .wp-block-input,
    .wp-block-select {
      width: 100%;
      font-size: 1rem;
      padding: 0.5em;
    }
    .sqmu-escrow > * + * { margin-top: 1em; }
  </style>
</head>
<body>
  <div class="wp-block-group sqmu-escrow" id="widget">
    <h3 class="wp-block-heading">Escrow Funding</h3>
    <div class="wp-block-buttons">
      <div class="wp-block-button"><button id="connect" class="wp-block-button__link">Connect Wallet</button></div>
      <div class="wp-block-button"><button id="disconnect" class="wp-block-button__link" style="display:none;">Disconnect</button></div>
    </div>
    <p>Token: <span id="token-symbol">-</span></p>
    <p>State: <span id="escrow-state">-</span></p>
    <p>EOI Deposited: <span id="deposit-eoi">0</span></p>
    <p>Initial Deposited: <span id="deposit-initial">0</span></p>
    <p>Balance Deposited: <span id="deposit-balance">0</span></p>
    <div class="wp-block-group">
      <label for="deposit-amount" class="has-text-align-center" style="font-weight:bold;">Amount</label>
      <input id="deposit-amount" type="number" step="0.01" class="wp-block-input">
    </div>
    <div class="wp-block-group">
      <label for="deposit-stage" class="has-text-align-center" style="font-weight:bold;">Stage</label>
      <select id="deposit-stage" class="wp-block-select">
        <option value="0">EOI</option>
        <option value="1">Initial</option>
        <option value="2">Balance</option>
      </select>
    </div>
    <div class="wp-block-group">
      <label for="buyer-email" class="has-text-align-center" style="font-weight:bold;">Email (optional)</label>
      <input id="buyer-email" type="email" class="wp-block-input">
    </div>
    <div class="wp-block-buttons"><div class="wp-block-button"><button id="deposit-btn" class="wp-block-button__link" disabled>Deposit</button></div></div>
    <pre id="escrow-status"></pre>
  </div>
  <script>
    // This widget loads https://np-vincent.github.io/SQMU-Scroll/js/escrow.js
    // and connects to the Escrow contract to handle stablecoin deposits.
  </script>
</body>
</html>
